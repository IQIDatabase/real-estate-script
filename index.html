<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Message Scripts</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        Helvetica, Arial, sans-serif;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
    }

    .tab-btn {
      border: none;
      padding: 10px 18px;
      border-radius: 999px;
      background: #eef1f4;
      color: #555;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.06);
    }

    .tab-btn:hover {
      background: #dfe8f2;
      transform: translateY(-1px);
    }

    .tab-btn.active {
      background: #068fff;
      color: #fff;
      box-shadow: 0 6px 14px rgba(6, 143, 255, 0.35);
      transform: scale(1.05);
    }

    body {
      position: relative;
      margin: 0;
      width: 100%;
      padding: 20px 0 20px 0;
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      background: #f4f6f8;
      color: #333;
    }

    .container {
      overflow: auto;
      /* scrolling still works */
      scrollbar-width: none;
      /* Firefox */
      max-width: 520px;
      width: 100%;
      /* margin: 40px auto; */
      height: 100%;
      padding: 20px;
      overflow: scroll;

    }

    #container1 {
      max-width: 500px;
      width: 100%;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .card {
      position: relative;
      background: #ffffff;
      border-radius: 12px;
      padding: 22px;
      margin-bottom: 18px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
      line-height: 1.6;
      font-size: 15px;
      cursor: pointer;
    }

    .card:hover {
      transform: scale(1.02);
      transition: 0.5s;

    }

    .label {
      font-size: 12px;
      font-weight: 600;
      color: #068fff;
      margin-bottom: 10px;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: 0.04em;
    }

    .copy-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      border: none;
      background: #eef1f4;
      color: #333;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .copy-btn:hover {
      background: #dfe5ea;
    }

    .modal {
      width: 100px;
      background: #ffffff;
      color: #068fff;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
      box-shadow: 0 0 15px 5px rgba(231, 231, 231, 0.336);
      /* x-offset, y-offset, blur, spread, color */

    }

    .back {
      /* top: -40px; */
      display: none;
      align-items: center;
      backdrop-filter: blur(2px);
      justify-content: center;
      /* overflow-y: hidden; */
      position: absolute;
      z-index: 999;
      width: 100%;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.719);
    }

    .text {
      white-space: pre-line;
    }

    @media (max-width: 480px) {
      .container {
        margin: 20px auto;
      }
    }
  </style>
</head>

<body>
  <div class="back" id="back">
    <div class="modal">
      Copied!
    </div>
  </div>

  <div class="container" id="container">
    <a href="viewing.html"
      style="background-color: #068fff;color: white;text-decoration: none;padding: 5px;border-radius: 50px">Viewing
      Request</a>
    <h1 id="scrpt">Loading...</h1>


    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab(this,'OWNER')">Owner</button>
      <button class="tab-btn" onclick="switchTab(this,'CLIENT')">Client</button>
      <button class="tab-btn" onclick="switchTab(this,'SCHEDULE')">Schedule</button>
    </div>
    <div id="container1"></div>
    <script>
      let scripts = []
      function get(id) {
        return document.getElementById(id)
      }
      //   function copyText(button) {
      //     const text = button.parentElement.querySelector(".text").innerText;

      //     navigator.clipboard.writeText(text).then(() => {
      //       button.classList.add("copied");
      //       button.innerText = "Copied!";

      //       setTimeout(() => {
      //         button.classList.remove("copied");
      //         button.innerText = "Copy";
      //       }, 1500);
      //     });
      //   }
      function copyCardText(card) {
        get("back").style.display = "flex"
        // document.body.style.overflow = "hidden"; 
        setTimeout(() => {
          get("back").style.display = "none"
          // document.body.style.overflow = "auto";

        }, 1000);

        const text = card.querySelector(".text").innerText.trim();
        navigator.clipboard.writeText(text).then(() => {
          const originalBg = card.style.background;
          card.style.background = "#6bb5ff";
          setTimeout(() => {
            card.style.background = originalBg || "#ffffff";
          }, 800);
        });
      }

      function switchTab(button, type) {
        document.querySelectorAll(".tab-btn").forEach(btn =>
          btn.classList.remove("active")
        );

        button.classList.add("active");
        renderTab(type); // ðŸ‘ˆ HERE
      }




      window.addEventListener("load", async () => {
        await fetch_me();
        renderTab("OWNER"); // default tab

      });
      async function renderTab(type) {
        const container = get("container1");
        container.innerHTML = "";

        console.log(scripts)
        let count = 1;
        scripts.forEach(([text, role]) => {
          if (role === type) {
            container.innerHTML += `
        <div class="card" onclick="copyCardText(this)">
          <div class="label">${type} â€¢ Script ${count}</div>
          <div class="text">${text}</div>
        </div>
      `;
            count++;
          }
        });
      }
      let link =
        "https://script.google.com/macros/s/AKfycbzzvP3RGPnKddPE0A42o1paLrGdsxDGJAc3_lh7urONvmNvlDRkA2Jc_UAXd6aHA9y8/exec";

      async function fetch_me() {
        let response = await fetch(link);
        response = await response.json();
        get("scrpt").innerHTML = "Message Scripts"

        scripts = await response
          .slice(1) // skip header
          .map(row => {
            // row = cut(row[0])
            row = row[0]
            const text = row?.[0]?.toString().trim();
            const role = row?.[1]?.toString().trim().toUpperCase();
            console.log(role)
            if (!text) return null; // skip empty text
            return [text, role];
          })
          .filter(Boolean); // remove nulls

        //   let container = get("container")
        //   for (let x = 1; x < response.length; x++) {
        //     // alert(response[x])
        //     let curr_value = response[x].toString().trim()
        //     container.innerHTML += `<div class="card" onclick="copyCardText(this)">
        //   <div class="label">Script ${x}</div>
        //   <div class="text">${curr_value}
        //   </div>
        // </div>`
        //   }

      }

    </script>


</html>
